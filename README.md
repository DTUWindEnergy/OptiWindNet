interarray
==========

Tools for designing the electrical cable network (collection system) for offshore wind power plants.

About interarray
----------------

``interarray`` provides a framework to obtain optimal or near-optimal cable routes for a given turbine layout within the cable-laying boundaries. It provides high-level access to heuristic, meta-heuristic and mathematical optimization approaches to the problem.

The design of the collection system is subject to constraints:
- circuits can only branch inside a wind turbine, if at all;
- cables cannot cross each other;
- cable routes must fall inside the allowed area, avoiding obstacles within it;
- the maximum current capacity of the cable must be respected.

This problem has similarities with two classic operations research problems:
- The capacitaded minimum spanning tree (CMST);
- The open and capacitated vehicle routing problem (OCVRP);

Neither of the classic formulations consider route crossings, which is the main achievement of ``interarray``. Whether the approach is via the CMST or via the OCVRP depends on the viability of branching the circuit on turbines.

The heuristics are based on extensions to the Esau-Williams heuristic. The meta-heuristic is [implemented elsewhere](https://github.com/vidalt/HGS-CVRP), of which `interarray` is just a user. The mathematical optimization uses mixed-integer linear programming (MILP) models, which can be solved using Google's OR-Tools or by calling solvers via ``pyomo``, e.g.: Coin-OR Branch-and-Cut (CBC), IBM's CPLEX, Gurobi, among others.

Installation
------------

``interarray`` is not yet a proper python package. For the time being:

```
git clone https://github.com/mdealencar/interarray.git
```

And add the `interarray` folder to somewhere Python looks for packages.


Requirements
------------

External requirements are in [requirements.txt](requirements.txt). Branch-and-cut solvers for the MILP formulations called via ``pyomo`` are not listed as requirements.

[PythonCDT](https://github.com/artem-ogre/PythonCDT) is a requirement that is not `pip`- nor `conda`-installable. Please install it from the repository as indicated there.

```
conda create --name «env_interarray» --file requirements.txt
```

Or create your Python environment, activate it, and call:

```
pip install -r requirements.txt
```

Documentation
-------------

Some usage examples can be found in [notebooks](notebooks).

The heuristics implemented in this repository (release 0.0.1) are presented and analysed in the MSc thesis [Optimization heuristics for offshore wind power plant collection systems design](https://fulltext-gateway.cvt.dk/oafilestore?oid=62dddf809a5e7116caf943f3&targetid=62dddf80a41ba354e4ed35bc) (DTU Wind - Technical University of Denmark, July 4, 2022)

The meta-heuristic used is [vidalt/HGS-CVRP: Modern implementation of the hybrid genetic search (HGS) algorithm specialized to the capacitated vehicle routing problem (CVRP). This code also includes an additional neighborhood called SWAP\*.](https://github.com/vidalt/HGS-CVRP) via its Python bindings [chkwon/PyHygese: A Python wrapper for the Hybrid Genetic Search algorithm for Capacitated Vehicle Routing Problems (HGS-CVRP)](https://github.com/chkwon/PyHygese).

The cable routing relies on a navigation mesh generated by the library [artem-ogre/CDT: Constrained Delaunay Triangulation (C++)](https://github.com/artem-ogre/CDT) via its Python bindings - [artem-ogre/PythonCDT: Constrained Delaunay Triangulation (Python)](https://github.com/artem-ogre/PythonCDT).
